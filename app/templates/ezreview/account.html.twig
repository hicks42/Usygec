{% extends 'ezreview_base.html.twig' %}

{% block title %}Compte de
	{{ user.company}}
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	{# <link rel="stylesheet" href="http://localhost:8080/wip.scss"> #}
{% endblock stylesheets %}

{% block javascripts %}
	{{ parent() }}
	{{ encore_entry_script_tags('upload') }}
	{# <script src="http://localhost:8080/wip.js"></script> #}
{% endblock javascripts %}

{% block content %}
	<div class="my-3">
		<div class="d-flex justify-content-between bg-light overflow-hidden p-2">
			<div class="col-md-8">
				<h4>Compte :
					{{ user.company}}</h4>
			</div>
			<div class="col-md-4">
				<a href="{{ path('user_edit') }}" class="btn btn-secondary btn-sm float-end">
					<i class="fa-solid fa-pen-to-square"></i>
					Modifier</a>
				<div class="row my-4"></div>
			</div>
		</div>
		<div class="d-flex justify-content-start bg-light overflow-hidden my-3 p-2">
			<div class="m-2">
				<h5>E-mail :
					<i class="fa-solid fa-arrow-right"></i>
					<span class="text-secondary">{{user.email}}</span>
				</h5>
				L'email est utilisé comme login et pour l'envois/réception de l'enquete
				<br>
				<small>(Contactez l'administrateur pour modification)</small>
			</div>
			<div class="mt-2"></div>
		</div>
		<div class="bg-light rounded overflow-hidden m-2 p-2">
			<div class="my-4">
				<h5>Etablissements:</h5>
				<ul class="structures">
					{% for structure in user.structures %}
						<li>
							<hr>
							<div class="d-flex flex-wrap justify-content-around align-items-center m-1 ml-4">
								<div class="col-xl-4 my-3">
									<div class="d-flex flex-column align-items-center">
										<i class="fa-solid fa-hospital lead my-2"></i>
										{{ structure.name }}
									</div>
								</div>
								<div class="d-flex flex-nowrap justify-content-around col-xl-6 col-sm-12 my-3">
									<a href="{{ path('enquete', {'id': structure.id}) }}" class="btn btn-secondary btn-sm w-3 mx-1">
										<i class="fa-regular fa-envelope lead"></i><br>
										Envoyer mail</a>

									<a href="#" type="button" data-structureid="{{structure.id}}" class="upload-btn btn btn-secondary btn-sm w-3 mx-1">
										<i class="fa-regular fa-file-lines lead"></i><br>
										Charger un fichier</a>

									<a href="{{ path('qr_gen', {id: structure.id}) }}" type="button" data-structureid="{{structure.id}}" class="qrcode-btn btn btn-secondary btn-sm w-3 mx-1">
										<i class="fa-solid fa-qrcode lead"></i><br>
										Créer un code</a>

								</div>
							</div>
						</li>
					{% endfor %}
				</ul>
			</div>
		</div>
	</div>

	<div class="upload-container d-flex justify-content-around">
		<div class="upload-popup">
			<button class="close-popup">x</button>
			{{ form_start(form, {"method": "POST"}) }}
			<h6 id="form-title" class="my-4">Selectionnez un fichier csv</h6>
			{{ form_row(form.csvFile) }}
			<button type="submit" class="submit-upload w-100">Traiter</button>
			{{ form_widget(form._token) }}
			{{ form_end(form, {'render_rest': false}) }}
		</div>
	</div>
{% endblock %}
